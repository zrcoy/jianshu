{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _classCallCheck from\"C:/Users/zhang/React Projects/jianshu/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/zhang/React Projects/jianshu/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/zhang/React Projects/jianshu/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/zhang/React Projects/jianshu/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{connect}from'react-redux';import{Link}from'react-router-dom';import{CSSTransition}from'react-transition-group';import{actionCreators}from'./store';import{actionCreators as loginActionCreators}from'../../pages/login/store';import{HeaderWrapper,Logo,Nav,NavItem,NavSearch,Addition,Button,SearchWrapper,SearchInfo,SearchInfoTitle,SearchInfoSwitch,SearchInfoItem,SearchInfoList}from'./style';var Header=/*#__PURE__*/function(_Component){_inherits(Header,_Component);var _super=_createSuper(Header);function Header(){_classCallCheck(this,Header);return _super.apply(this,arguments);}_createClass(Header,[{key:\"getListArea\",value:function getListArea(){var _this=this;var _this$props=this.props,focused=_this$props.focused,list=_this$props.list,page=_this$props.page,handleMouseEnter=_this$props.handleMouseEnter,handleMouseLeave=_this$props.handleMouseLeave,mouseIn=_this$props.mouseIn,handleChangePage=_this$props.handleChangePage,totalPage=_this$props.totalPage;var newList=list.toJS();var pageList=[];if(newList.length){for(var i=(page-1)*10;i<page*10;i++){if(newList[i]){pageList.push(/*#__PURE__*/_jsx(SearchInfoItem,{children:newList[i]},newList[i]));}}}if(focused||mouseIn){return/*#__PURE__*/_jsxs(SearchInfo,{onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,children:[/*#__PURE__*/_jsxs(SearchInfoTitle,{children:[\"\\u70ED\\u95E8\\u641C\\u7D22\",/*#__PURE__*/_jsxs(SearchInfoSwitch,{onClick:function onClick(){return handleChangePage(page,totalPage,_this.spinIcon);},children:[/*#__PURE__*/_jsx(\"span\",{ref:function ref(icon){_this.spinIcon=icon;},className:\"iconfont spin\",children:\"\\uE72B\"}),\"\\u6362\\u4E00\\u6279\"]})]}),/*#__PURE__*/_jsx(SearchInfoList,{children:pageList})]});}else{return null;}}},{key:\"render\",value:function render(){var _this$props2=this.props,focused=_this$props2.focused,handleInputFocus=_this$props2.handleInputFocus,handleInputBlur=_this$props2.handleInputBlur,list=_this$props2.list,login=_this$props2.login,logout=_this$props2.logout;return/*#__PURE__*/_jsxs(HeaderWrapper,{children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(Logo,{})}),/*#__PURE__*/_jsxs(Nav,{children:[/*#__PURE__*/_jsx(NavItem,{className:\"left active\",children:\"\\u9996\\u9875\"}),/*#__PURE__*/_jsx(NavItem,{className:\"left\",children:\"\\u4E0B\\u8F7DApp\"}),login?/*#__PURE__*/_jsx(NavItem,{onClick:logout,className:\"right\",children:\"\\u9000\\u51FA\"}):/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(NavItem,{className:\"right\",children:\"\\u767B\\u5F55\"})}),/*#__PURE__*/_jsx(NavItem,{className:\"right\",children:/*#__PURE__*/_jsx(\"span\",{className:\"iconfont\",children:\"\\uE636\"})}),/*#__PURE__*/_jsxs(SearchWrapper,{children:[/*#__PURE__*/_jsx(CSSTransition,{in:focused,timeout:200,classNames:\"slide\",children:/*#__PURE__*/_jsx(NavSearch,{className:focused?'focused':'',onFocus:function onFocus(){return handleInputFocus(list);},onBlur:handleInputBlur})}),/*#__PURE__*/_jsx(\"span\",{className:focused?'focused iconfont zoom':'iconfont zoom',children:\"\\uE60F\"}),this.getListArea()]})]}),/*#__PURE__*/_jsxs(Addition,{children:[/*#__PURE__*/_jsx(Link,{to:\"/write\",children:/*#__PURE__*/_jsxs(Button,{className:\"writting\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"iconfont\",children:\"\\uE600\"}),\"\\u5199\\u6587\\u7AE0\"]})}),/*#__PURE__*/_jsx(Button,{className:\"reg\",children:\"\\u6CE8\\u518C\"})]})]});}}]);return Header;}(Component);var mapStateToProps=function mapStateToProps(state){return{focused:state.getIn(['header','focused']),list:state.getIn(['header','list']),page:state.getIn(['header','page']),totalPage:state.getIn(['header','totalPage']),mouseIn:state.getIn(['header','mouseIn']),login:state.getIn(['login','login'])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{handleInputFocus:function handleInputFocus(list){if(list.size===0){dispatch(actionCreators.getList());}dispatch(actionCreators.searchFocus());},handleInputBlur:function handleInputBlur(){dispatch(actionCreators.searchBlur());},handleMouseEnter:function handleMouseEnter(){dispatch(actionCreators.mouseEnter());},handleMouseLeave:function handleMouseLeave(){dispatch(actionCreators.mouseLeave());},handleChangePage:function handleChangePage(page,totalPage,spin){var originAngle=spin.style.transform.replace(/[^0-9]/ig,'');if(originAngle){originAngle=parseInt(originAngle,10);}else{originAngle=0;}spin.style.transform='rotate('+(originAngle+360)+'deg)';if(page<totalPage){dispatch(actionCreators.changePage(page+1));}else{dispatch(actionCreators.changePage(1));}},logout:function logout(){dispatch(loginActionCreators.logout());}};};export default connect(mapStateToProps,mapDispatchToProps)(Header);","map":{"version":3,"sources":["C:/Users/zhang/React Projects/jianshu/src/common/header/index.js"],"names":["React","Component","connect","Link","CSSTransition","actionCreators","loginActionCreators","HeaderWrapper","Logo","Nav","NavItem","NavSearch","Addition","Button","SearchWrapper","SearchInfo","SearchInfoTitle","SearchInfoSwitch","SearchInfoItem","SearchInfoList","Header","props","focused","list","page","handleMouseEnter","handleMouseLeave","mouseIn","handleChangePage","totalPage","newList","toJS","pageList","length","i","push","spinIcon","icon","handleInputFocus","handleInputBlur","login","logout","getListArea","mapStateToProps","state","getIn","mapDispatchToProps","dispatch","size","getList","searchFocus","searchBlur","mouseEnter","mouseLeave","spin","originAngle","style","transform","replace","parseInt","changePage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport { actionCreators} from './store';\r\nimport { actionCreators as loginActionCreators } from '../../pages/login/store';\r\nimport {\r\n  HeaderWrapper,\r\n  Logo,\r\n  Nav,\r\n  NavItem,\r\n  NavSearch,\r\n  Addition,\r\n  Button,\r\n  SearchWrapper,\r\n  SearchInfo,\r\n  SearchInfoTitle,\r\n  SearchInfoSwitch,\r\n  SearchInfoItem,\r\n  SearchInfoList,\r\n} from './style';\r\n\r\n\r\n\r\nclass Header extends Component{\r\n  getListArea() {\r\n    const {focused, list, page , handleMouseEnter, handleMouseLeave, mouseIn, handleChangePage, totalPage} = this.props;\r\n    const newList = list.toJS();\r\n    const pageList = [];\r\n\r\n    if(newList.length)\r\n    {\r\n      for(let i = (page - 1) * 10; i < page * 10; i++)\r\n      {\r\n        if(newList[i]){\r\n          pageList.push(\r\n            <SearchInfoItem key={newList[i]}>{newList[i]}</SearchInfoItem>\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    if(focused || mouseIn){\r\n      return(\r\n        <SearchInfo \r\n          onMouseEnter={handleMouseEnter}\r\n          onMouseLeave={handleMouseLeave}\r\n        >\r\n          <SearchInfoTitle>\r\n            热门搜索\r\n            <SearchInfoSwitch \r\n              onClick={() => handleChangePage(page, totalPage, this.spinIcon)}\r\n            >\r\n              <span ref={(icon) => {this.spinIcon = icon}} className=\"iconfont spin\">&#xe72b;</span>\r\n              换一批\r\n            </SearchInfoSwitch>\r\n          </SearchInfoTitle>\r\n          <SearchInfoList>\r\n            {pageList}\r\n          </SearchInfoList>\r\n        </SearchInfo>\r\n      )\r\n    }\r\n    else{\r\n      return null;\r\n    }\r\n  }\r\n\r\n\r\n  render(){\r\n    const {focused, handleInputFocus, handleInputBlur, list, login,logout} = this.props;\r\n    return(\r\n      <HeaderWrapper>\r\n        <Link to='/'>\r\n          <Logo />\r\n        </Link>\r\n        <Nav>\r\n          <NavItem className='left active'>首页</NavItem>\r\n          <NavItem className='left'>下载App</NavItem>\r\n          {\r\n            login ? \r\n            <NavItem onClick={logout} className='right'>退出</NavItem> : \r\n            <Link to='/login'><NavItem className='right'>登录</NavItem></Link>\r\n          }\r\n          \r\n          <NavItem className='right'>\r\n            <span className=\"iconfont\">&#xe636;</span>\r\n          </NavItem>\r\n          <SearchWrapper>\r\n            <CSSTransition\r\n              in={focused}\r\n              timeout={200}\r\n              classNames=\"slide\"\r\n            >\r\n              <NavSearch\r\n                className={focused ? 'focused': ''}\r\n                onFocus={() => handleInputFocus(list)}\r\n                onBlur={handleInputBlur}\r\n              ></NavSearch>\r\n            </CSSTransition>\r\n            <span className={focused ? 'focused iconfont zoom': 'iconfont zoom'}>&#xe60f;</span>\r\n            {this.getListArea()}\r\n          </SearchWrapper>\r\n        </Nav>\r\n        <Addition>\r\n          <Link to='/write'>\r\n            <Button className='writting'>\r\n              <span className=\"iconfont\">&#xe600;</span>\r\n              写文章\r\n            </Button>\r\n          </Link>\r\n          <Button className='reg'>注册</Button>\r\n        </Addition>\r\n      </HeaderWrapper>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    focused: state.getIn(['header','focused']),\r\n    list: state.getIn(['header','list']),\r\n    page: state.getIn(['header','page']),\r\n    totalPage: state.getIn(['header','totalPage']),\r\n    mouseIn: state.getIn(['header','mouseIn']),\r\n    login: state.getIn(['login', 'login'])\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return{\r\n    handleInputFocus(list) {\r\n      if(list.size === 0){\r\n        dispatch(actionCreators.getList());\r\n      }\r\n      dispatch(actionCreators.searchFocus()); \r\n    },\r\n    handleInputBlur() {\r\n      dispatch(actionCreators.searchBlur()); \r\n    },\r\n    handleMouseEnter(){\r\n      dispatch(actionCreators.mouseEnter());\r\n    },\r\n    handleMouseLeave(){\r\n      dispatch(actionCreators.mouseLeave());\r\n    },\r\n    handleChangePage(page, totalPage, spin){\r\n      let originAngle = spin.style.transform.replace(/[^0-9]/ig,'');\r\n      if(originAngle)\r\n      {\r\n        originAngle = parseInt(originAngle, 10);\r\n      }else{\r\n        originAngle = 0;\r\n      }\r\n      spin.style.transform = 'rotate(' + (originAngle+360) + 'deg)';\r\n      if(page<totalPage)\r\n      {\r\n        dispatch(actionCreators.changePage(page+1));\r\n      }else{\r\n        dispatch(actionCreators.changePage(1));\r\n      }\r\n    },\r\n    logout(){\r\n      dispatch(loginActionCreators.logout())\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);"]},"metadata":{},"sourceType":"module"}